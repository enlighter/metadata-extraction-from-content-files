<?xml version="1.0" encoding="utf-8" ?>

<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.1//EN" "http://www.w3.org/TR/xhtml11/DTD/xhtml11.dtd">

<html xmlns="http://www.w3.org/1999/xhtml"><head><title>Using global effect properties</title><link rel="stylesheet" href="epub.css" type="text/css"/><meta name="generator" content="DocBook XSL Stylesheets V1.75.2"/></head><body id="page"><div class="section" title="Using global effect properties"><div class="titlepage"><div><div><h1 class="title"><a id="ch11lvl1sec86"/>Using global effect properties</h1></div></div></div><p>The effects module in jQuery <a id="id894" class="indexterm"/>includes a handy <code class="literal">$.fx</code> object that we can access when we want to change characteristics of our animations across the board. Although some of this object's properties are undocumented and intended for use solely within the library itself, others are provided as tools for globally altering the way our animations run. In the following examples, we'll take a look at a few of the documented properties.</p><div class="section" title="Disabling all effects"><div class="titlepage"><div><div><h2 class="title"><a id="ch11lvl2sec127"/>Disabling all effects</h2></div></div></div><p>We have already discussed a way to halt <a id="id895" class="indexterm"/>animations that are currently running, but what if we need to disable all animations entirely? We may, for example, wish to provide animations by default, but disable those animations for low-resource devices such as feature phones in which animations could look choppy, or for users who find animations distracting. To do so, we can simply set the <code class="literal">$.fx.off</code> property to <code class="literal">true</code>. For our demonstration, we will display a previously hidden button to allow the user to toggle animations on and off:</p><div class="informalexample"><pre class="programlisting">  $('#fx-toggle').show().on('click', function() {
    $.fx.off = !$.fx.off;
  });</pre></div><p>
<span class="emphasis"><em>Listing 11.4</em></span>
</p><p>The hidden button is displayed between the introductory paragraph and the subsequent images:</p><div class="mediaobject"><img src="graphics/3145OS_11_03.jpg" alt="Disabling all effects"/></div><p>When the user clicks on the button to toggle animations off, subsequent animations such as our growing and shrinking images will occur instantaneously (with a duration of <code class="literal">0</code> milliseconds), and any callback functions will be called immediately thereafter.</p></div><div class="section" title="Defining effect durations"><div class="titlepage"><div><div><h2 class="title"><a id="ch11lvl2sec128"/>Defining effect durations</h2></div></div></div><p>Another property of the <code class="literal">$.fx</code> object <a id="id896" class="indexterm"/>is <code class="literal">speeds</code>. This property is an object itself, consisting of three properties, as evidenced by the jQuery core file:</p><div class="informalexample"><pre class="programlisting">speeds: {
  slow: 600,
  fast: 200,
  // Default speed
  _default: 400
}</pre></div><p>We've already learned that all of jQuery's animation methods provide an optional speed, or duration, argument. Looking at the <code class="literal">$.fx.speeds</code> object, we see that the strings <code class="literal">slow</code> and <code class="literal">fast</code> map up to 600 milliseconds and 200 milliseconds respectively. Each time an animation method is called, jQuery goes through the following steps to determine the duration of the effect, in this order:</p><div class="orderedlist"><ol class="orderedlist arabic"><li class="listitem">It checks if <code class="literal">$.fx.off</code> is <code class="literal">true</code>. If so, it sets the duration to <code class="literal">0</code>.</li><li class="listitem">It checks if the duration passed is a number. If so, it sets the duration to that number of milliseconds.</li><li class="listitem">It checks if the duration pass matches one of the property keys of the <code class="literal">$.fx.speeds</code> object. If so, it sets the duration to the value of the property.</li><li class="listitem">If the duration is not set by any of the above checks, it sets the duration to the value of <code class="literal">$.fx.speeds._default</code>.</li></ol></div><p>Given this information, we now know that passing any string duration other than <code class="literal">slow</code> or <code class="literal">fast</code> will result in a duration of 400 milliseconds. We can also see that adding our own custom speed is as easy as adding another property to <code class="literal">$.fx.speeds</code>. If we write <code class="literal">$.fx.speeds.crawl = 1200</code>, for example, we can use <code class="literal">'crawl'</code> for any animation method's speed argument to run the animation for 1200 milliseconds, like so:</p><div class="informalexample"><pre class="programlisting">$(someElement).animate({width: '300px'}, 'crawl');</pre></div><p>Although typing <code class="literal">'crawl'</code> is no easier than typing <code class="literal">1200</code>, custom speeds can come in handy in larger projects when a number of animations that share a certain speed need to change. In such cases, we could just change the value of <code class="literal">$.fx.speeds.crawl</code> rather than search throughout the project for <code class="literal">1200</code> and replace each one only if it represents an animation speed.</p><p>While custom speeds can be useful, perhaps even more useful is the ability to change the default speed. We can do this by setting the <code class="literal">_default</code> property:</p><div class="informalexample"><pre class="programlisting">$.fx.speeds._default = 250;</pre></div><p>
<span class="emphasis"><em>Listing 11.5</em></span>
</p><p>Now that we have defined a new faster default speed, any new animations we add will use it unless we override their durations. To see this at work, we will introduce another interactive element to the page. When the user clicks on one of the portraits, we want to display the details associated with that person. We will create the illusion of the details <span class="emphasis"><em>unfolding</em></span> from the portrait by moving <a id="id897" class="indexterm"/>them out from under the portrait into their final positions:</p><div class="informalexample"><pre class="programlisting">$(document).ready(function() {
  function showDetails() {
    $(this).find('div').css({
      display: 'block',
      left: '-300px',
      top: 0
    }).each(function(index) {
      $(this).animate({
        left: 0,
        top: 25 * index
      });
    });
  }
  $('div.member').click(showDetails);
});</pre></div><p>
<span class="emphasis"><em>Listing 11.6</em></span>
</p><p>When a member is clicked, we use the <code class="literal">showDetails()</code> function as a handler. This function first sets the detail <code class="literal">&lt;div&gt;</code> elements in their starting positions, underneath the member's portrait. Then it animates each of the elements into its final position. By calling <code class="literal">.each()</code>, we can calculate a separate final <code class="literal">top</code> position for each element.</p><p>After the animation, the detail text is visible:</p><div class="mediaobject"><img src="graphics/3145OS_11_04.jpg" alt="Defining effect durations"/></div><p>Since the <code class="literal">.animate()</code> method <a id="id898" class="indexterm"/>calls are made on different elements, they happen simultaneously rather than being queued. And, since the calls do not specify a duration, they all use the new default duration of 250 milliseconds.</p><p>When another member is clicked, we want to hide the previously displayed one. We can easily track which details are currently on the screen with the use of a class:</p><div class="informalexample"><pre class="programlisting">var $member = $(this);
if ($member.hasClass('active')) {
  return;
}

$('div.member.active')
  .removeClass('active')
  .children('div').fadeOut();
$member.addClass('active');</pre></div><p>
<span class="emphasis"><em>Listing 11.7</em></span>
</p><p>This new code, placed at the beginning of <code class="literal">showDetails()</code>, adds an <code class="literal">active</code> class to members that are clicked. By finding this class, we can easily locate the elements that are visible and fade them away. We can also use the class to return without taking action if the clicked member is already active.</p><p>Note that our <code class="literal">.fadeOut()</code> call also <a id="id899" class="indexterm"/>uses the faster 250 millisecond duration we've defined. The defaults apply to jQuery's pre-packaged effects just as they do to custom <code class="literal">.animate()</code> calls.</p></div></div></body></html>
