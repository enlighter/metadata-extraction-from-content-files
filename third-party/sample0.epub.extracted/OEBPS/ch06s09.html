<?xml version="1.0" encoding="utf-8" ?>

<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.1//EN" "http://www.w3.org/TR/xhtml11/DTD/xhtml11.dtd">

<html xmlns="http://www.w3.org/1999/xhtml"><head><title>Exploring additional options</title><link rel="stylesheet" href="epub.css" type="text/css"/><meta name="generator" content="DocBook XSL Stylesheets V1.75.2"/></head><body id="page"><div class="section" title="Exploring additional options"><div class="titlepage"><div><div><h1 class="title"><a id="ch06lvl1sec53"/>Exploring additional options</h1></div></div></div><p>The Ajax toolbox provided by jQuery is stocked well. We've covered several of the available options, but we've just scratched the surface. While there are too many variants to cover here, we will give an overview of some of the more prominent ways to customize Ajax communications.</p><div class="section" title="The low-level Ajax method"><div class="titlepage"><div><div><h2 class="title"><a id="ch06lvl2sec71"/>The low-level Ajax method</h2></div></div></div><p>We have seen several methods <a id="id526" class="indexterm"/>that all initiate Ajax transactions. Internally, jQuery maps each of these methods onto variants of the <code class="literal">$.ajax()</code> global function. Rather than presuming one particular type of Ajax activity, this function accepts an object containing options that can be used to customize its behavior.</p><p>Our first example, <span class="emphasis"><em>Listing 6.1</em></span>, loaded an HTML snippet using <code class="literal">$('#dictionary').load('a.html')</code>. This action could instead be accomplished with <code class="literal">$.ajax()</code> as follows:</p><div class="informalexample"><pre class="programlisting">$.ajax({
  url: 'a.html',
  success: function(data) {
    $('#dictionary').html(data);
  }
});</pre></div><p>
<span class="emphasis"><em>Listing 6.21</em></span>
</p><p>We see here that <code class="literal">$.ajax()</code> takes a single <a id="id527" class="indexterm"/>object as its argument (or optionally a URL string as its first argument and an object as its second). This <code class="literal">settings</code> object has over 30 possible options, offering a great <a id="id528" class="indexterm"/>deal of flexibility. A few of the special capabilities that come with using a low-level <code class="literal">$.ajax()</code> call include:</p><div class="itemizedlist"><ul class="itemizedlist"><li class="listitem" style="list-style-type: disc">Preventing the browser from caching responses from the server; this can be useful if the server produces its data dynamically</li><li class="listitem" style="list-style-type: disc">Suppressing the global handlers (such as ones registered with <code class="literal">$.ajaxStart()</code>) that are normally triggered by all Ajax interactions</li><li class="listitem" style="list-style-type: disc">Providing a username and password for authentication with the remote host</li></ul></div><p>For details on using these and other options, consult the online jQuery API reference (<a class="ulink" href="http://api.jquery.com/jQuery.ajax">http://api.jquery.com/jQuery.ajax</a>).</p></div><div class="section" title="Modifying default options"><div class="titlepage"><div><div><h2 class="title"><a id="ch06lvl2sec72"/>Modifying default options</h2></div></div></div><p>The <code class="literal">$.ajaxSetup()</code> function allows <a id="id529" class="indexterm"/>us to specify default values for each of the options used when Ajax methods are called. It takes an object with options identical to the ones available to <code class="literal">$.ajax()</code> itself and causes these values to be used on all subsequent Ajax requests unless overridden.</p><div class="informalexample"><pre class="programlisting">$.ajaxSetup({
  url: 'a.html',
  type: 'POST',
  dataType: 'html'
});

$.ajax({
  type: 'GET',
  success: function(data) {
    $('#dictionary').html(data);
  }
});</pre></div><p>
<span class="emphasis"><em>Listing 6.22</em></span>
</p><p>This sequence of operations behaves the same as our preceding <code class="literal">$.ajax()</code> example. Note that the URL of the request is specified as a default value by the <code class="literal">$.ajaxSetup()</code> call, so it does not have to be provided when <code class="literal">$.ajax()</code> is invoked. In contrast, the <code class="literal">type</code> parameter is given a default value of POST, but this can still be overridden in the <code class="literal">$.ajax()</code> call to GET.</p></div><div class="section" title="Loading parts of an HTML page"><div class="titlepage"><div><div><h2 class="title"><a id="ch06lvl2sec73"/>Loading parts of an HTML page</h2></div></div></div><p>The first and simplest Ajax technique <a id="id530" class="indexterm"/>we discussed was fetching an HTML snippet and placing it on a page. Sometimes, though, the server already provides the HTML we need, but it is surrounded by an HTML page we do not want. We already saw how the server can be set up to deliver different content for Ajax requests. When it is inconvenient to make the server provide the data in the format we desire, jQuery can help us on the client end.</p><p>Consider a case like our first example, but in which the document containing the dictionary definitions is a complete HTML page called <code class="literal">h.html</code>:</p><div class="informalexample"><pre class="programlisting">&lt;html lang="en"&gt;
  &lt;head&gt;
    &lt;meta charset="utf-8"/&gt;
    &lt;title&gt;The Devil's Dictionary: H&lt;/title&gt;
    
    &lt;link rel="stylesheet" href="dictionary.css"
      media="screen" /&gt;
  &lt;/head&gt;
  &lt;body&gt;
    &lt;div id="container"&gt;
      &lt;div id="header"&gt;
        &lt;h2&gt;The Devil's Dictionary: H&lt;/h2&gt;
        &lt;div class="author"&gt;by Ambrose Bierce&lt;/div&gt;
      &lt;/div&gt;

      &lt;div id="dictionary"&gt;
        &lt;div class="entry"&gt;
          &lt;h3 class="term"&gt;HABEAS CORPUS&lt;/h3&gt;
          &lt;div class="part"&gt;n.&lt;/div&gt;
          &lt;div class="definition"&gt;
            A writ by which a man may be taken out of jail
            when confined for the wrong crime.
          &lt;/div&gt;
        &lt;/div&gt;

        &lt;div class="entry"&gt;
          &lt;h3 class="term"&gt;HABIT&lt;/h3&gt;
          &lt;div class="part"&gt;n.&lt;/div&gt;
          &lt;div class="definition"&gt;
            A shackle for the free.
          &lt;/div&gt;
        &lt;/div&gt;
      &lt;/div&gt;

    &lt;/div&gt;
  &lt;/body&gt;
&lt;/html&gt;</pre></div><p>We can load the whole document into our page using the technique from <span class="emphasis"><em>Listing 6.1</em></span>:</p><div class="informalexample"><pre class="programlisting">// Unfinished code
$(document).ready(function() {
  $('#letter-h a').click(function(event) {
    event.preventDefault();
    $('#dictionary').load('h.html');
  });
});</pre></div><p>
<span class="emphasis"><em>Listing 6.23</em></span>
</p><p>This produces a strange effect <a id="id531" class="indexterm"/>due to the pieces of the HTML page we don't want to include. The loaded content includes the page title and author name, which is therefore repeated on the page:</p><div class="mediaobject"><img src="graphics/3145OS_06_13.jpg" alt="Loading parts of an HTML page"/></div><p>To remove these extraneous bits, we can use another <a id="id532" class="indexterm"/>feature of the <code class="literal">.load()</code> method. When specifying the URL of the document to load, we can also provide a jQuery selector expression. If present, this expression is used to locate a portion of the loaded document. Only the matched part of the document is inserted into the page. In this case, we can use this technique to pull only the <a id="id533" class="indexterm"/>dictionary entries from the document and insert them:</p><div class="informalexample"><pre class="programlisting">$(document).ready(function() {
  $('#letter-h a').click(function(event) {
    event.preventDefault();
    $('#dictionary').load('h.html .entry');
  });
});</pre></div><p>
<span class="emphasis"><em>Listing 6.24</em></span>
</p><p>Now the irrelevant portions of the document are excluded from the page:</p><div class="mediaobject"><img src="graphics/3145OS_06_14.jpg" alt="Loading parts of an HTML page"/></div></div></div></body></html>
