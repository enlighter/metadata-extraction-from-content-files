<?xml version="1.0" encoding="utf-8" ?>

<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.1//EN" "http://www.w3.org/TR/xhtml11/DTD/xhtml11.dtd">

<html xmlns="http://www.w3.org/1999/xhtml"><head><title>Copying elements</title><link rel="stylesheet" href="epub.css" type="text/css"/><meta name="generator" content="DocBook XSL Stylesheets V1.75.2"/></head><body id="page"><div class="section" title="Copying elements"><div class="titlepage"><div><div><h1 class="title"><a id="ch05lvl1sec40"/>Copying elements</h1></div></div></div><p>So far in this chapter we have inserted <a id="id428" class="indexterm"/>newly created elements, moved elements from one location in the document to another, and wrapped new elements around existing ones. Sometimes, though, we may want to copy elements. For example, a navigation menu that appears in the page's header could be copied and placed in the footer as well. Whenever elements can be copied to enhance a page visually, we have an opportunity to use jQuery. After all, why write something twice and double our chance of error when we can write it once and let jQuery do the heavy lifting?</p><p>For copying elements, jQuery's <code class="literal">.clone()</code> method is just what we need; it takes any set of matched elements and creates a copy of them for later use. As in the case of the <code class="literal">$()</code> function's element-creation process we explored earlier in this chapter, the copied elements will not appear in the document until we apply one of the insertion methods.</p><p>For example, the following line <a id="id429" class="indexterm"/>creates a copy of the first paragraph inside <code class="literal">&lt;div class="chapter"&gt;</code>:</p><div class="informalexample"><pre class="programlisting">$('div.chapter p:eq(0)').clone();</pre></div><p>This alone is not enough to change the content of the page. We can make the cloned paragraph appear before <code class="literal">&lt;div class="chapter"&gt;</code> with an insertion method:</p><div class="informalexample"><pre class="programlisting">$('div.chapter p:eq(0)').clone().insertBefore('div.chapter');</pre></div><p>This will cause the first paragraph to appear twice. So, to use a familiar analogy, <code class="literal">.clone()</code> is related to the insertion methods just as <span class="emphasis"><em>copy</em></span> is to <span class="emphasis"><em>paste</em></span>.</p><div class="note" title="Note" style=""><div class="inner"><h3 class="title"><a id="tip30"/>Tip</h3><p>
<span class="strong"><strong>Clone with events</strong></span>
</p><p>The <code class="literal">.clone()</code> method, by default, does not copy any events that are bound to the matching element or any of its descendants. However, it can take a single Boolean parameter that, when set to true (<code class="literal">.clone(true)</code>), clones events as well. This convenient event cloning allows us to avoid having to deal with manually rebinding events, as was discussed in <a class="link" href="ch03.html" title="Chapter&#xA0;3.&#xA0;Handling Events">Chapter 3</a>, <span class="emphasis"><em>Handling Events</em></span>.</p></div></div><div class="section" title="Cloning for pull quotes"><div class="titlepage"><div><div><h2 class="title"><a id="ch05lvl2sec62"/>Cloning for pull quotes</h2></div></div></div><p>Many websites, like their print counterparts, use <span class="strong"><strong>pull quotes</strong></span> to emphasize small portions of text and attract the reader's eye. <a id="id430" class="indexterm"/>A pull quote is simply an excerpt from the main document that is presented with a special graphical treatment alongside the text. We can easily accomplish this embellishment with the <code class="literal">.clone()</code> method. First, let's take another look at the third paragraph of our example text:</p><div class="informalexample"><pre class="programlisting">&lt;p&gt;
  &lt;span class="pull-quote"&gt;It is a Law of Nature 
  &lt;span class="drop"&gt;with us&lt;/span&gt; that a male child shall 
  have &lt;strong&gt;one more side&lt;/strong&gt; than his father&lt;/span&gt;, 
  so that each generation shall rise (as a rule) one step in 
  the scale of development and nobility. Thus the son of a 
  Square is a Pentagon; the son of a Pentagon, a Hexagon; and 
  so on.
&lt;/p&gt;</pre></div><p>Notice that the paragraph begins with <code class="literal">&lt;span class="pull-quote"&gt;</code>. This is the class we will be targeting for cloning. Once the copied text inside that <code class="literal">&lt;span&gt;</code> tag is pasted into another place, we need to modify its style properties to set it apart from the rest of the text.</p><p>To accomplish this type of styling, we'll add a <code class="literal">pulled</code> class to the copied <code class="literal">&lt;span&gt;</code>. In our stylesheet, that class receives the following style rule:</p><div class="informalexample"><pre class="programlisting">.pulled {
  position: absolute;
  width: 120px;
  top: -20px;
  right: -180px;
  padding: 20px;
  font: italic 1.2em "Times New Roman", Times, serif;
  background: #e5e5e5;
  border: 1px solid #999;
  border-radius: 8px;
  box-shadow: 1px 1px 8px rgba(0, 0, 0, 0.6);
}</pre></div><p>An element with this class is visually differentiated from the main content by applying style rules for background, border, font, and so on. Most importantly, it's absolutely positioned, 20 pixels above and 20 <a id="id431" class="indexterm"/>pixels to the right of the nearest (<code class="literal">absolute</code> or <code class="literal">relative</code>) positioned ancestor in the DOM. If no ancestor has positioning (other than <code class="literal">static</code>) applied, the pull quote will be positioned relative to the document <code class="literal">&lt;body&gt;</code>. Because of this, we need to make sure in the jQuery code that the cloned pull quote's parent element has <code class="literal">position:relative</code> set.</p><div class="note" title="Note" style=""><div class="inner"><h3 class="title"><a id="tip31"/>Tip</h3><p>
<span class="strong"><strong>CSS position calculation</strong></span>
</p><p>While the top positioning is fairly intuitive, it may not be clear at first how the pull quote box will be located 20 pixels to the right of its positioned parent. We derive the number first from the total width of the pull-quote box, which is the value of the <code class="literal">width</code> property plus the left and right padding, or <code class="literal">145px + 5px + 10px = 160px</code>. We then set the <code class="literal">right</code> property of the pull quote. A value of <code class="literal">0</code> would align the pull quote's right side with that of its parent. Therefore, to place its left side 20 pixels to the right of the parent, we need to move it in a negative direction 20 pixels more than its total width, or <code class="literal">-180px</code>.</p></div></div><p>Now we can consider the jQuery code needed to apply this style. We'll start with a selector expression to find all of the <code class="literal">&lt;span class="pull-quote"&gt;</code> elements and apply the <code class="literal">position: relative</code> style to each parent element as we just discussed:</p><div class="informalexample"><pre class="programlisting">$(document).ready(function() {
  $('span.pull-quote').each(function(index) {
    var $parentParagraph = $(this).parent('p');
    $parentParagraph.css('position', 'relative');
  });
});</pre></div><p>
<span class="emphasis"><em>Listing 5.17</em></span>
</p><p>We'll be referring to the parent paragraph again later, so the <code class="literal">$parentParagraph</code> variable will prove to improve performance and readability.</p><p>Next we need to create the pull quote itself, taking advantage of the CSS we've prepared. We need to clone each <code class="literal">&lt;span&gt;</code> tag, <a id="id432" class="indexterm"/>add the <code class="literal">pulled</code> class to the copy, and insert it into the beginning of its parent paragraph:</p><div class="informalexample"><pre class="programlisting">$(document).ready(function() {
  $('span.pull-quote').each(function(index) {
    var $parentParagraph = $(this).parent('p');
    $parentParagraph.css('position', 'relative');
    var $clonedCopy = $(this).clone();
    $clonedCopy
      .addClass('pulled')
      .prependTo($parentParagraph);
  });
});</pre></div><p>
<span class="emphasis"><em>Listing 5.18</em></span>
</p><p>Once again, we're introducing a variable here (<code class="literal">$clonedCopy</code>) that will be useful later.</p><p>Because we're using absolute positioning for the pull quote, the placement of it within the paragraph is irrelevant. As long as it remains inside the paragraph, it will be positioned in relation to the top and the right of the paragraph, based on our CSS rules.</p><p>The pull quote now appears alongside its originating paragraph, as intended:</p><div class="mediaobject"><img src="graphics/3145OS_05_10.jpg" alt="Cloning for pull quotes"/></div><p>This is a good start. For our next enhancement, we'll clean up the content of the pull quotes a bit.</p></div></div></body></html>
