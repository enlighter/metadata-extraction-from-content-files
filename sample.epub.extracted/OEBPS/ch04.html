<?xml version="1.0" encoding="utf-8" ?>

<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.1//EN" "http://www.w3.org/TR/xhtml11/DTD/xhtml11.dtd">

<html xmlns="http://www.w3.org/1999/xhtml"><head><title>Chapter&#xA0;4.&#xA0;Styling and Animating</title><link rel="stylesheet" href="epub.css" type="text/css"/><meta name="generator" content="DocBook XSL Stylesheets V1.75.2"/></head><body id="page"><div class="chapter" title="Chapter&#xA0;4.&#xA0;Styling and Animating"><div class="titlepage"><div><div><h1 class="title"><a id="ch04"/>Chapter&#xA0;4.&#xA0;Styling and Animating</h1></div></div></div><p>If actions speak louder than words, then in the JavaScript world, effects make actions speak louder still. With jQuery, we can easily add impact to our actions through a set of simple visual effects and even craft our own more sophisticated animations.</p><p>The effects offered by jQuery supply simple visual flourishes that grant a sense of movement and modernity to any page. However, apart from being mere decoration, they can also provide important usability enhancements that help orient the user when there is some change on a page (especially common in Ajax applications).</p><p>In this chapter, we will cover:</p><div class="itemizedlist"><ul class="itemizedlist"><li class="listitem" style="list-style-type: disc">Changing the styling of elements on the fly</li><li class="listitem" style="list-style-type: disc">Hiding and showing elements with various built-in effects</li><li class="listitem" style="list-style-type: disc">Creating custom animations of elements</li><li class="listitem" style="list-style-type: disc">Sequencing effects to happen one after another</li></ul></div><div class="section" title="Modifying CSS with inline properties"><div class="titlepage"><div><div><h1 class="title"><a id="ch04lvl1sec31"/>Modifying CSS with inline properties</h1></div></div></div><p>Before we jump <a id="id266" class="indexterm"/>
<a id="id267" class="indexterm"/>into the nifty jQuery effects, a quick look at CSS is in order. In previous chapters, we have been modifying a document's appearance by defining styles for classes in a separate stylesheet and then adding or removing those classes with jQuery. Typically, this is the preferred process for injecting CSS into HTML because it respects the stylesheet's role in dealing with the presentation of a page. However, there may be times when we need to apply styles that haven't been or can't easily be defined in a stylesheet. Fortunately, jQuery <a id="id268" class="indexterm"/>offers the <code class="literal">.css()</code> method for such occasions.</p><p>This method acts as both a getter and a setter. To get the value of a single style property, we simply pass the name of the property as a string and get a string in return. To get the value of multiple style properties, we can pass the property names as an array of strings to get an object of property-value pairs in return. Multiword property names such as <code class="literal">backgroundColor</code> can be interpreted by jQuery when in hyphenated CSS notation (<code class="literal">background-color</code>) or camel-cased DOM notation (<code class="literal">backgroundColor</code>):</p><div class="informalexample"><pre class="programlisting">// Get a single property's value
.css('property')
// returns "value"

// Get multiple properties' values
.css(['property1', 'property-2'])
// returns {"property1": "value1", "property-2": "value2"}</pre></div><p>For setting style properties, <a id="id269" class="indexterm"/>the <code class="literal">.css()</code> method comes in two flavors. One flavor takes a single style property <a id="id270" class="indexterm"/>
<a id="id271" class="indexterm"/>and its value and the other takes an object of property-value pairs:</p><div class="informalexample"><pre class="programlisting">// Single property and its value
.css('property', 'value')

// Object of property-value pairs
.css({
  property1: 'value1',
  'property-2': 'value2'
})</pre></div><p>These simple key-value collections, called object literals, are real JavaScript objects that are created directly in code.</p><div class="note" title="Note" style=""><div class="inner"><h3 class="title"><a id="tip21"/>Tip</h3><p>
<span class="strong"><strong>Object literal notation</strong></span>
</p><p>In a property value, strings are enclosed in quotes as usual, but other data types such as numbers do not require them. Since property names are strings, they typically would be contained in quotes. However, quotation marks are not required for property names if they are valid JavaScript identifiers, such as when they are written in camel-cased DOM notation.</p></div></div><p>We use the <code class="literal">.css()</code> method the <a id="id272" class="indexterm"/>same way we've been using <code class="literal">.addClass()</code>; we apply it to a jQuery <a id="id273" class="indexterm"/>object, which in turn points to a collection of DOM elements. To demonstrate this, we'll play with a style switcher similar to the one from <a class="link" href="ch03.html" title="Chapter&#xA0;3.&#xA0;Handling Events">Chapter 3</a>, <span class="emphasis"><em>Handling Events</em></span>:</p><div class="informalexample"><pre class="programlisting">  &lt;div id="switcher"&gt;
  &lt;div class="label"&gt;Text Size&lt;/div&gt;
  &lt;button id="switcher-default"&gt;Default&lt;/button&gt;
  &lt;button id="switcher-large"&gt;Bigger&lt;/button&gt;
  &lt;button id="switcher-small"&gt;Smaller&lt;/button&gt;
&lt;/div&gt;
&lt;div class="speech"&gt;
  &lt;p&gt;Fourscore and seven years ago our fathers brought forth
       on this continent a new nation, conceived in liberty, 
       and dedicated to the proposition that all men are created 
       equal.&lt;/p&gt;
  ...
&lt;/div&gt;</pre></div><div class="note" title="Note" style=""><div class="inner"><h3 class="title"><a id="tip22"/>Tip</h3><p>
<span class="strong"><strong>Downloadable code examples</strong></span>
</p><p>As with many of the HTML, CSS, and JavaScript examples in this book, the previous markup is merely a fragment of the complete document. To experiment with the examples, we can download them from the Packt Publishing website at <a class="ulink" href="http://www.packtpub.com/support">http://www.packtpub.com/support</a>. In addition, the examples can be viewed in an interactive browser at <a class="ulink" href="http://book.learningjquery.com/">http://book.learningjquery.com/</a>.</p></div></div><p>By linking to a stylesheet <a id="id274" class="indexterm"/>
<a id="id275" class="indexterm"/>with a few basic style rules, the page will initially look like this:</p><div class="mediaobject"><img src="graphics/3145OS_04_01.jpg" alt="Modifying CSS with inline properties"/></div><p>Once we're done with our code, clicking on the <span class="strong"><strong>Bigger</strong></span> and <span class="strong"><strong>Smaller</strong></span> buttons will increase or decrease the text size of <code class="literal">&lt;div class="speech"&gt;</code>, while clicking on the <span class="strong"><strong>Default</strong></span> button will reset <code class="literal">&lt;div class="speech"&gt;</code> to its original text size.</p><div class="section" title="Setting computed style-property values"><div class="titlepage"><div><div><h2 class="title"><a id="ch04lvl2sec41"/>Setting computed style-property values</h2></div></div></div><p>If all we wanted was to change the font size a single time to a predetermined value, we could still use the <code class="literal">.addClass()</code> method. <a id="id276" class="indexterm"/>But, let's suppose now that we want the text to continue increasing or decreasing incrementally each time the respective <a id="id277" class="indexterm"/>button is clicked. Although it might be possible to define a separate class for each click and iterate through them, a more straightforward approach would be to compute the new text size each time by getting the current size and increasing it by a set factor (for example, 40 percent).</p><p>Our code will start with the <code class="literal">$(document).ready()</code> and <code class="literal">$('#switcher-large').click()</code> event handlers:</p><div class="informalexample"><pre class="programlisting">$(document).ready(function() {
  $('#switcher-large').click(function() {
  });
});</pre></div><p>
<span class="emphasis"><em>Listing 4.1</em></span>
</p><p>Next, the font size can be easily <a id="id278" class="indexterm"/>discovered by using the <code class="literal">.css()</code> method: <code class="literal">$('div.speech').css('fontSize')</code>. However, the returned value is a string, containing both the numeric font size value and the units of that value (<code class="literal">px</code>). We'll need to strip the unit label off in order to perform calculations with the numeric value. Also, when we plan to use a jQuery object more than once, it's generally a good idea to cache the selector by storing the resulting jQuery object in a variable. We'll take care of these needs with the introduction of a couple of local variables:</p><div class="informalexample"><pre class="programlisting">$(document).ready(function() {
  var $speech = $('div.speech');
  $('#switcher-large').click(function() {
    var num = parseFloat($speech.css('fontSize'));
  });
});</pre></div><p>
<span class="emphasis"><em>Listing 4.2</em></span>
</p><p>The first line inside <code class="literal">$(document).ready()</code> now creates a variable containing a jQuery object pointing to <code class="literal">&lt;div class="speech"&gt;</code>. Notice the use of a dollar (<code class="literal">$</code>) sign in the variable name, <code class="literal">$speech</code>. Since the dollar sign is a legal character in JavaScript identifiers, we can use it as a reminder that the variable is storing a jQuery object. Unlike in other programming languages such as PHP, the dollar symbol holds no special significance in JavaScript, the language of jQuery.</p><p>Inside the <code class="literal">.click()</code> handler, <a id="id279" class="indexterm"/>we use <code class="literal">parseFloat()</code> to get the font size property's numeric <a id="id280" class="indexterm"/>value only. The <code class="literal">parseFloat()</code> function looks at a string from the left-hand side to the right-hand side until it encounters a non-numeric character. The string of digits is converted into a floating-point (decimal) number. For example, it would convert the string <code class="literal">'12'</code> to the number <code class="literal">12</code>. In addition, it strips non-numeric trailing characters from the string, so <code class="literal">'12px'</code> becomes <code class="literal">12</code> as well. If the string begins with a non-numeric character, <code class="literal">parseFloat()</code> returns <code class="literal">NaN</code>, which stands for <span class="emphasis"><em>Not a Number</em></span>.</p><p>All that's left to do is to modify the parsed numeric value and to reset the font size based on the new value. For our example, we'll increase the font size by 40 percent each time the button is clicked. To achieve <a id="id281" class="indexterm"/>this, we'll multiply <code class="literal">num</code> by <code class="literal">1.4</code> and then set the font size by concatenating <code class="literal">num</code> and <code class="literal">'px'</code>:</p><div class="informalexample"><pre class="programlisting">$(document).ready(function() {
  var $speech = $('div.speech');
  $('#switcher-large').click(function() {
    var num = parseFloat($speech.css('fontSize'));
    num *= 1.4;
    $speech.css('fontSize', num + 'px');
  });
});</pre></div><p>
<span class="emphasis"><em>Listing 4.3</em></span>
</p><p>Now when a user clicks on the <span class="strong"><strong>Bigger</strong></span> button, the text becomes larger. Another click and the text becomes larger:</p><div class="mediaobject"><img src="graphics/3145OS_04_02.jpg" alt="Setting computed style-property values"/></div><p>To get the <span class="strong"><strong>Smaller</strong></span> button to <a id="id282" class="indexterm"/>decrease the font size, we will divide rather than multiply: &#x2014;<code class="literal">num /= 1.4</code>. Better still, we'll combine the two into a single <code class="literal">.click()</code> handler on all the <code class="literal">&lt;button&gt;</code> elements within <code class="literal">&lt;div id="switcher"&gt;</code>. Then, after finding the numeric value, we can either multiply or divide depending on the ID of the button that was clicked. <span class="emphasis"><em>Listing 4.4</em></span> illustrates this.</p><div class="informalexample"><pre class="programlisting">$(document).ready(function() {
  var $speech = $('div.speech');
  $('#switcher button').click(function() {
    var num = parseFloat($speech.css('fontSize'));
    if (this.id == 'switcher-large') {
      num *= 1.4;
    } else if (this.id == 'switcher-small') {
      num /= 1.4;
    }
    $speech.css('fontSize', num + 'px');
  });
});</pre></div><p>
<span class="emphasis"><em>Listing 4.4</em></span>
</p><p>Recall from <a class="link" href="ch03.html" title="Chapter&#xA0;3.&#xA0;Handling Events">Chapter 3</a>, <span class="emphasis"><em>Handling Events</em></span>, that we can access the <code class="literal">id</code> property of the DOM element referred to by <code class="literal">this</code>, which appears here inside the <code class="literal">if</code> and <code class="literal">else if</code> statements. Here, it is more efficient to use <code class="literal">this</code> than to create a jQuery object just to test the value of a property.</p><p>It would also be nice to have a way to return the font size to its initial value. To allow the user to do so, we can simply store the <a id="id283" class="indexterm"/>font size in a variable immediately when the DOM is ready. We can then restore this value whenever the <span class="strong"><strong>Default</strong></span> button is clicked. To <a id="id284" class="indexterm"/>handle this <code class="literal">click</code> event, we could add another <code class="literal">else if</code> statement<code class="literal">.</code>Instead, though, we will use a <code class="literal">switch</code> statement, which is appropriate when we have several cases to handle:</p><div class="informalexample"><pre class="programlisting">$(document).ready(function() {
  var $speech = $('div.speech');
  var defaultSize = $speech.css('fontSize');
  $('#switcher button').click(function() {
    var num = parseFloat($speech.css('fontSize'));
    switch (this.id) {
      case 'switcher-large':
        num *= 1.4;      
        break;
      case 'switcher-small':
        num /= 1.4;
        break;
      default:
        num = parseFloat(defaultSize);        
    }
    $speech.css('fontSize', num + 'px');
  });
});</pre></div><p>
<span class="emphasis"><em>Listing 4.5</em></span>
</p><p>Here, we're still checking <a id="id285" class="indexterm"/>the value of <code class="literal">this.id</code> and changing the font size based on it, but if its value is neither <code class="literal">'switcher-large'</code> nor <code class="literal">'switcher-small'</code>, it will default to the initial font size.</p></div><div class="section" title="Using vendor-specific style properties"><div class="titlepage"><div><div><h2 class="title"><a id="ch04lvl2sec42"/>Using vendor-specific style properties</h2></div></div></div><p>When browser vendors <a id="id286" class="indexterm"/>
<a id="id287" class="indexterm"/>introduce experimental style properties, they often prefix the property name until the browser's implementation aligns with the CSS specification. When both the implementation and the specification are stable enough, vendors will shed that prefix and allow the standard name to be used. In a stylesheet, therefore, it is not uncommon to see a set of CSS declarations like the following:</p><div class="informalexample"><pre class="programlisting">-webkit-property-name: value;
-moz-property-name: value;
-ms-property-name: value;
-o-property-name: value;
property-name: value;</pre></div><p>If we wanted to apply the same in JavaScript, we would need to test for the existence of the DOM equivalent of these variations: <code class="literal">propertyName</code>, <code class="literal">WebkitPropertyName</code>, <code class="literal">msPropertyName</code>, and so on. With jQuery, however, we can simply the standard property name, like<code class="literal">.css('propertyName', 'value')</code>. If that name is not found as a property of the style object, jQuery loops through the vendor prefixes behind the scenes&#x2014;<code class="literal">Webkit</code>, <code class="literal">O</code>, <code class="literal">Moz</code>, and <code class="literal">ms</code>&#x2014;and uses the first one it does find as a property, if any.</p></div></div></div></body></html>
